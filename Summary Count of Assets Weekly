SELECT Policies.PRODUCER_CODE AS Producer, Policies.POL_NUM AS Policy, Policies.PRODUCT AS Product, Policies.CUSTOMER_NAME AS Program, Policies.MARKET AS Market, CLng(Format([Transactions_Enrollments]![COV_START],"yyyymm")) AS Period, CLng(Format([Transactions_Enrollments]![COV_START],"yyyy")) AS [Year], CLng(Format([Transactions_Enrollments]![COV_START],"mm")) AS [Month], CLng(Format([Transactions_Enrollments]![COV_START],"ww")) AS Week, Transactions_Assets.CLASS AS Type, Transactions_Assets.ASSET_STATE AS State, Count([Transactions_Assets]![ASSET_ID]) AS Assets
FROM Policies INNER JOIN (Transactions_Enrollments INNER JOIN Transactions_Assets ON (Transactions_Enrollments.ENROLL_TRAN = Transactions_Assets.ENROLL_TRAN) AND (Transactions_Enrollments.CONTRACT_ID = Transactions_Assets.CONTRACT_ID) AND (Transactions_Enrollments.CONTRACT_NUM = Transactions_Assets.CONTRACT_NUM) AND (Transactions_Enrollments.POL_NUM = Transactions_Assets.POL_NUM)) ON Policies.POL_NUM = Transactions_Enrollments.POL_NUM
GROUP BY Policies.PRODUCER_CODE, Policies.POL_NUM, Policies.PRODUCT, Policies.CUSTOMER_NAME, Policies.MARKET, CLng(Format([Transactions_Enrollments]![COV_START],"yyyymm")), CLng(Format([Transactions_Enrollments]![COV_START],"yyyy")), CLng(Format([Transactions_Enrollments]![COV_START],"mm")), CLng(Format([Transactions_Enrollments]![COV_START],"ww")), Transactions_Assets.CLASS, Transactions_Assets.ASSET_STATE
HAVING (((Policies.PRODUCER_CODE)=199257) AND ((Policies.PRODUCT)=2370) AND ((Policies.MARKET)<>"Medical")) OR (((Policies.PRODUCER_CODE)=573389) AND ((Policies.PRODUCT)=2370)) OR (((Policies.PRODUCER_CODE)=247858)) OR (((Policies.PRODUCER_CODE)=247864)) OR (((Policies.PRODUCER_CODE)=569260)) OR (((Policies.PRODUCER_CODE)=569277)) OR (((Policies.PRODUCER_CODE)=569279)) OR (((Policies.PRODUCER_CODE)=569291)) OR (((Policies.PRODUCER_CODE)=247868)) OR (((Policies.PRODUCER_CODE)=247870)) OR (((Policies.PRODUCER_CODE)=247872)) OR (((Policies.PRODUCER_CODE)=247873)) OR (((Policies.PRODUCER_CODE)=199257) AND ((Policies.MARKET)="Banner")) OR (((Policies.PRODUCER_CODE)=247868))
ORDER BY Policies.PRODUCER_CODE, Policies.POL_NUM, CLng(Format([Transactions_Enrollments]![COV_START],"yyyymm"));
